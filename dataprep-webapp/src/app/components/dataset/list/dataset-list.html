<!--
  ~ ============================================================================
  ~
  ~  Copyright (C) 2006-2016 Talend Inc. - www.talend.com
  ~
  ~  This source code is available under agreement available at
  ~  https://github.com/Talend/data-prep/blob/master/LICENSE
  ~
  ~  You should have received a copy of the agreement
  ~  along with this program; if not, write to Talend SA
  ~  9 rue Pages 92150 Suresnes, France
  ~
  ~ ============================================================================
  -->

<div id="dataset-inventory-list" class="inventory-list">
    <inventory-item
            id="dataset_{{$index}}"
            ng-repeat="dataset in $ctrl.state.inventory.datasets track by dataset.id"
            item="dataset"
            type="dataset"
            details="DATASET_DETAILS"
            file-model="$ctrl.updateDatasetFile"
            related-inventories="dataset.preparations"
            related-inventories-type="preparation"
            open="$ctrl.UploadWorkflowService.openDataset"
            open-related-inventory="$ctrl.PreparationService.open"
            update="$ctrl.uploadUpdatedDatasetFile"
            copy="$ctrl.clone"
            edit="$ctrl.editLocation"
            process-certification="$ctrl.processCertification"
            remove="$ctrl.remove"
            rename="$ctrl.rename"
            is-item-shared="$ctrl.isItemShared"
            toggle-favorite="$ctrl.DatasetService.toggleFavorite">
    </inventory-item>

    <talend-modal fullscreen="false"
                  state="$ctrl.showModal"
                  close-button="true"
                  disable-enter="true">
        <div ng-show="!$ctrl.isFetchingParameters">
            <div class="modal-title">Edit Talend Job dataset</div>
            <br/>
            <form name="$ctrl.liveDatasetForm" ng-submit="$ctrl.liveDatasetForm.$valid && $ctrl.submit()">

                <transform-params parameters="$ctrl.liveDatasetFormParameters"></transform-params>

                <div class="modal-buttons">
                    <button class="talend-modal-close btn-secondary modal-secondary-button"
                            type="button"
                            translate-once="CANCEL"></button>
                    <button class="talend-modal-close btn-primary modal-primary-button"
                            ng-disabled="$ctrl.liveDatasetForm.$invalid"
                            translate-once="OK"></button>
                </div>
            </form>
        </div>
        <div id="import-ghost"
             ng-show="$ctrl.isFetchingParameters"
             class="loading-container">
            <div class="loading-msg">
                <span class="wait-icon continuous-rotate" ><i data-icon="c" class="icon"></i></span>
                <span class="wait-text" translate-once="IMPORT_WAIT"></span>
            </div>
        </div>
    </talend-modal>
</div>